/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:27<00:27, 27.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:43<00:00, 21.02s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:43<00:00, 22.00s/it]
/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
  0%|          | 0/4419 [00:00<?, ?it/s]  0%|          | 1/4419 [00:03<4:40:20,  3.81s/it]  0%|          | 2/4419 [00:04<2:33:21,  2.08s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (2433 > 2048). Running this sequence through the model will result in indexing errors
  0%|          | 3/4419 [00:07<2:49:42,  2.31s/it]  0%|          | 4/4419 [00:09<2:54:06,  2.37s/it]  0%|          | 5/4419 [00:11<2:49:20,  2.30s/it]  0%|          | 6/4419 [00:14<2:46:41,  2.27s/it]  0%|          | 7/4419 [00:16<2:44:51,  2.24s/it]  0%|          | 8/4419 [00:17<2:11:21,  1.79s/it]  0%|          | 9/4419 [00:17<1:48:57,  1.48s/it]  0%|          | 10/4419 [00:18<1:33:50,  1.28s/it]  0%|          | 11/4419 [00:19<1:23:23,  1.14s/it]  0%|          | 12/4419 [00:20<1:14:32,  1.01s/it]  0%|          | 13/4419 [00:21<1:08:24,  1.07it/s]  0%|          | 14/4419 [00:22<1:12:15,  1.02it/s]  0%|          | 15/4419 [00:23<1:15:10,  1.02s/it]  0%|          | 16/4419 [00:24<1:12:25,  1.01it/s]  0%|          | 17/4419 [00:25<1:13:36,  1.00s/it]  0%|          | 18/4419 [00:26<1:14:25,  1.01s/it]  0%|          | 19/4419 [00:28<1:52:26,  1.53s/it]  0%|          | 20/4419 [00:31<2:18:59,  1.90s/it]  0%|          | 21/4419 [00:34<2:35:15,  2.12s/it]  0%|          | 22/4419 [00:36<2:46:44,  2.28s/it]  1%|          | 23/4419 [00:37<2:15:51,  1.85s/it]  1%|          | 24/4419 [00:38<1:54:16,  1.56s/it]  1%|          | 25/4419 [00:39<1:39:09,  1.35s/it]  1%|          | 26/4419 [00:40<1:28:32,  1.21s/it]  1%|          | 27/4419 [00:41<1:26:30,  1.18s/it]  1%|          | 28/4419 [00:42<1:25:09,  1.16s/it]  1%|          | 29/4419 [00:43<1:24:03,  1.15s/it]  1%|          | 30/4419 [00:45<1:31:12,  1.25s/it]  1%|          | 31/4419 [00:46<1:37:45,  1.34s/it]  1%|          | 32/4419 [00:47<1:20:09,  1.10s/it]  1%|          | 33/4419 [00:47<1:07:50,  1.08it/s]  1%|          | 34/4419 [00:48<1:02:58,  1.16it/s]  1%|          | 35/4419 [00:49<59:16,  1.23it/s]    1%|          | 36/4419 [00:50<56:40,  1.29it/s]  1%|          | 37/4419 [00:51<1:02:48,  1.16it/s]  1%|          | 38/4419 [00:52<1:07:03,  1.09it/s]  1%|          | 39/4419 [00:53<1:10:03,  1.04it/s]  1%|          | 40/4419 [00:55<1:50:32,  1.51s/it]  1%|          | 41/4419 [00:58<2:18:53,  1.90s/it]  1%|          | 42/4419 [01:01<2:46:00,  2.28s/it]  1%|          | 43/4419 [01:05<3:04:55,  2.54s/it]  1%|          | 44/4419 [01:06<2:32:20,  2.09s/it]  1%|          | 45/4419 [01:07<2:09:28,  1.78s/it]  1%|          | 46/4419 [01:08<1:53:25,  1.56s/it]  1%|          | 47/4419 [01:08<1:31:06,  1.25s/it]  1%|          | 48/4419 [01:09<1:15:27,  1.04s/it]  1%|          | 49/4419 [01:09<1:04:33,  1.13it/s]  1%|          | 50/4419 [01:10<56:51,  1.28it/s]    1%|          | 51/4419 [01:13<1:38:05,  1.35s/it]  1%|          | 52/4419 [01:15<2:07:01,  1.75s/it]  1%|          | 53/4419 [01:18<2:27:16,  2.02s/it]  1%|          | 54/4419 [01:19<2:12:03,  1.82s/it]  1%|          | 55/4419 [01:21<2:01:23,  1.67s/it]  1%|▏         | 56/4419 [01:22<1:54:00,  1.57s/it]  1%|▏         | 57/4419 [01:23<1:48:47,  1.50s/it]  1%|▏         | 58/4419 [01:31<3:58:19,  3.28s/it]  1%|▏         | 59/4419 [01:39<5:38:04,  4.65s/it]  1%|▏         | 60/4419 [01:46<6:39:36,  5.50s/it]  1%|▏         | 61/4419 [01:55<7:53:13,  6.52s/it]  1%|▏         | 62/4419 [02:01<7:55:08,  6.54s/it]  1%|▏         | 63/4419 [02:08<7:56:43,  6.57s/it]  1%|▏         | 64/4419 [02:10<6:07:54,  5.07s/it]  1%|▏         | 65/4419 [02:11<4:51:41,  4.02s/it]  1%|▏         | 66/4419 [02:12<3:47:08,  3.13s/it]  2%|▏         | 67/4419 [02:13<3:01:54,  2.51s/it]  2%|▏         | 68/4419 [02:14<2:30:14,  2.07s/it]  2%|▏         | 69/4419 [02:15<2:00:21,  1.66s/it]  2%|▏         | 70/4419 [02:16<1:40:25,  1.39s/it]  2%|▏         | 71/4419 [02:17<1:26:29,  1.19s/it]  2%|▏         | 72/4419 [02:19<1:58:53,  1.64s/it]  2%|▏         | 73/4419 [02:22<2:21:32,  1.95s/it]  2%|▏         | 74/4419 [02:25<2:37:29,  2.17s/it]  2%|▏         | 75/4419 [02:26<2:19:16,  1.92s/it]  2%|▏         | 76/4419 [02:27<2:06:27,  1.75s/it]  2%|▏         | 77/4419 [02:28<1:53:32,  1.57s/it]  2%|▏         | 78/4419 [02:30<1:44:28,  1.44s/it]  2%|▏         | 79/4419 [02:31<1:38:08,  1.36s/it]  2%|▏         | 80/4419 [02:34<2:13:07,  1.84s/it]  2%|▏         | 81/4419 [02:37<2:37:32,  2.18s/it]  2%|▏         | 82/4419 [02:38<2:18:26,  1.92s/it]  2%|▏         | 83/4419 [02:39<2:04:59,  1.73s/it]  2%|▏         | 84/4419 [02:40<1:39:38,  1.38s/it]  2%|▏         | 85/4419 [02:40<1:21:51,  1.13s/it]  2%|▏         | 86/4419 [02:41<1:09:24,  1.04it/s]  2%|▏         | 87/4419 [02:42<1:00:41,  1.19it/s]  2%|▏         | 88/4419 [02:42<54:39,  1.32it/s]    2%|▏         | 89/4419 [02:43<50:20,  1.43it/s]  2%|▏         | 90/4419 [02:43<47:21,  1.52it/s]  2%|▏         | 91/4419 [02:44<47:19,  1.52it/s]  2%|▏         | 92/4419 [02:45<47:10,  1.53it/s]  2%|▏         | 93/4419 [02:45<47:04,  1.53it/s]  2%|▏         | 94/4419 [02:46<55:36,  1.30it/s]  2%|▏         | 95/4419 [02:47<1:01:34,  1.17it/s]  2%|▏         | 96/4419 [02:48<1:07:22,  1.07it/s]  2%|▏         | 97/4419 [02:50<1:11:09,  1.01it/s]  2%|▏         | 98/4419 [02:51<1:14:00,  1.03s/it]  2%|▏         | 99/4419 [02:52<1:16:00,  1.06s/it]  2%|▏         | 100/4419 [02:54<1:31:14,  1.27s/it]  2%|▏         | 101/4419 [02:55<1:41:52,  1.42s/it]  2%|▏         | 102/4419 [02:57<1:45:31,  1.47s/it]  2%|▏         | 103/4419 [02:58<1:48:01,  1.50s/it]  2%|▏         | 104/4419 [03:00<1:49:48,  1.53s/it]  2%|▏         | 105/4419 [03:01<1:41:08,  1.41s/it]  2%|▏         | 106/4419 [03:02<1:35:04,  1.32s/it]  2%|▏         | 107/4419 [03:03<1:30:48,  1.26s/it]  2%|▏         | 108/4419 [03:05<1:27:46,  1.22s/it]  2%|▏         | 109/4419 [03:06<1:25:36,  1.19s/it]  2%|▏         | 110/4419 [03:07<1:28:49,  1.24s/it]  3%|▎         | 111/4419 [03:08<1:31:00,  1.27s/it]  3%|▎         | 112/4419 [03:10<1:44:37,  1.46s/it]  3%|▎         | 113/4419 [03:12<1:54:06,  1.59s/it]  3%|▎         | 114/4419 [03:14<2:00:41,  1.68s/it]  3%|▎         | 115/4419 [03:15<1:43:19,  1.44s/it]  3%|▎         | 116/4419 [03:16<1:31:20,  1.27s/it]  3%|▎         | 117/4419 [03:17<1:22:46,  1.15s/it]  3%|▎         | 118/4419 [03:18<1:21:58,  1.14s/it]  3%|▎         | 119/4419 [03:19<1:21:29,  1.14s/it]  3%|▎         | 120/4419 [03:20<1:21:06,  1.13s/it]  3%|▎         | 121/4419 [03:21<1:20:55,  1.13s/it]  3%|▎         | 122/4419 [03:22<1:20:40,  1.13s/it]  3%|▎         | 123/4419 [03:23<1:10:35,  1.01it/s]  3%|▎         | 124/4419 [03:24<1:03:32,  1.13it/s]  3%|▎         | 125/4419 [03:24<58:35,  1.22it/s]    3%|▎         | 126/4419 [03:28<1:55:08,  1.61s/it]  3%|▎         | 127/4419 [03:31<2:34:44,  2.16s/it]  3%|▎         | 128/4419 [03:35<3:02:23,  2.55s/it]  3%|▎         | 129/4419 [03:36<2:26:22,  2.05s/it]  3%|▎         | 130/4419 [03:36<2:01:08,  1.69s/it]  3%|▎         | 131/4419 [03:37<1:38:49,  1.38s/it]  3%|▎         | 132/4419 [03:38<1:23:02,  1.16s/it]  3%|▎         | 133/4419 [03:38<1:11:59,  1.01s/it]  3%|▎         | 134/4419 [03:39<1:09:01,  1.03it/s]  3%|▎         | 135/4419 [03:40<1:06:57,  1.07it/s]  3%|▎         | 136/4419 [03:42<1:19:32,  1.11s/it]  3%|▎         | 137/4419 [03:43<1:28:22,  1.24s/it]  3%|▎         | 138/4419 [03:45<1:39:18,  1.39s/it]  3%|▎         | 139/4419 [03:47<1:46:57,  1.50s/it]  3%|▎         | 140/4419 [03:48<1:38:31,  1.38s/it]  3%|▎         | 141/4419 [03:49<1:32:32,  1.30s/it]  3%|▎         | 142/4419 [03:50<1:28:17,  1.24s/it]  3%|▎         | 143/4419 [03:52<1:42:24,  1.44s/it]  3%|▎         | 144/4419 [03:54<1:52:14,  1.58s/it]  3%|▎         | 145/4419 [03:56<1:59:02,  1.67s/it]  3%|▎         | 146/4419 [03:57<1:55:35,  1.62s/it]  3%|▎         | 147/4419 [03:59<1:53:08,  1.59s/it]  3%|▎         | 148/4419 [04:00<1:51:26,  1.57s/it]  3%|▎         | 149/4419 [04:02<1:47:19,  1.51s/it]  3%|▎         | 150/4419 [04:03<1:44:21,  1.47s/it]  3%|▎         | 151/4419 [04:03<1:24:50,  1.19s/it]  3%|▎         | 152/4419 [04:04<1:11:07,  1.00s/it]  3%|▎         | 153/4419 [04:05<1:01:31,  1.16it/s]  3%|▎         | 154/4419 [04:05<55:00,  1.29it/s]    4%|▎         | 155/4419 [04:06<50:29,  1.41it/s]  4%|▎         | 156/4419 [04:06<47:19,  1.50it/s]  4%|▎         | 157/4419 [04:07<45:03,  1.58it/s]  4%|▎         | 158/4419 [04:08<46:30,  1.53it/s]  4%|▎         | 159/4419 [04:08<47:36,  1.49it/s]  4%|▎         | 160/4419 [04:09<48:24,  1.47it/s]  4%|▎         | 161/4419 [04:10<48:56,  1.45it/s]  4%|▎         | 162/4419 [04:10<46:14,  1.53it/s]  4%|▎         | 163/4419 [04:11<44:20,  1.60it/s]  4%|▎         | 164/4419 [04:11<44:45,  1.58it/s]  4%|▎         | 165/4419 [04:14<1:25:14,  1.20s/it]  4%|▍         | 166/4419 [04:16<1:53:39,  1.60s/it]  4%|▍         | 167/4419 [04:19<2:07:42,  1.80s/it]  4%|▍         | 168/4419 [04:20<1:48:43,  1.53s/it]  4%|▍         | 169/4419 [04:21<1:35:24,  1.35s/it]  4%|▍         | 170/4419 [04:25<2:46:21,  2.35s/it]  4%|▍         | 171/4419 [04:30<3:35:35,  3.05s/it]  4%|▍         | 172/4419 [04:35<4:09:53,  3.53s/it]  4%|▍         | 173/4419 [04:36<3:24:05,  2.88s/it]  4%|▍         | 174/4419 [04:37<2:52:04,  2.43s/it]  4%|▍         | 175/4419 [04:39<2:28:51,  2.10s/it]  4%|▍         | 176/4419 [04:40<2:12:37,  1.88s/it]  4%|▍         | 177/4419 [04:41<1:43:59,  1.47s/it]  4%|▍         | 178/4419 [04:41<1:24:03,  1.19s/it]  4%|▍         | 179/4419 [04:46<2:36:48,  2.22s/it]  4%|▍         | 180/4419 [04:50<3:27:35,  2.94s/it]  4%|▍         | 181/4419 [04:55<4:03:12,  3.44s/it]  4%|▍         | 182/4419 [04:56<3:09:55,  2.69s/it]  4%|▍         | 183/4419 [04:57<2:32:39,  2.16s/it]  4%|▍         | 184/4419 [05:04<4:11:09,  3.56s/it]  4%|▍         | 185/4419 [05:10<5:20:01,  4.54s/it]  4%|▍         | 186/4419 [05:13<4:35:36,  3.91s/it]  4%|▍         | 187/4419 [05:15<4:04:20,  3.46s/it]  4%|▍         | 188/4419 [05:17<3:23:06,  2.88s/it]  4%|▍         | 189/4419 [05:18<2:54:10,  2.47s/it]  4%|▍         | 190/4419 [05:19<2:24:10,  2.05s/it]  4%|▍         | 191/4419 [05:20<2:03:18,  1.75s/it]  4%|▍         | 192/4419 [05:22<2:03:01,  1.75s/it]  4%|▍         | 193/4419 [05:24<2:02:55,  1.75s/it]  4%|▍         | 194/4419 [05:26<2:02:50,  1.74s/it]  4%|▍         | 195/4419 [05:27<2:02:48,  1.74s/it]  4%|▍         | 196/4419 [05:30<2:22:01,  2.02s/it]  4%|▍         | 197/4419 [05:33<2:35:29,  2.21s/it]  4%|▍         | 198/4419 [05:34<2:07:25,  1.81s/it]  5%|▍         | 199/4419 [05:34<1:47:47,  1.53s/it]  5%|▍         | 200/4419 [05:35<1:25:47,  1.22s/it]  5%|▍         | 201/4419 [05:36<1:11:26,  1.02s/it]  5%|▍         | 202/4419 [05:37<1:26:49,  1.24s/it]  5%|▍         | 203/4419 [05:39<1:37:37,  1.39s/it]  5%|▍         | 204/4419 [05:40<1:31:48,  1.31s/it]  5%|▍         | 205/4419 [05:41<1:27:47,  1.25s/it]  5%|▍         | 206/4419 [05:42<1:24:53,  1.21s/it]  5%|▍         | 207/4419 [05:43<1:22:54,  1.18s/it]  5%|▍         | 208/4419 [05:45<1:31:25,  1.30s/it]  5%|▍         | 209/4419 [05:47<1:37:19,  1.39s/it]  5%|▍         | 210/4419 [05:47<1:24:14,  1.20s/it]  5%|▍         | 211/4419 [05:48<1:14:49,  1.07s/it]  5%|▍         | 212/4419 [05:49<1:08:27,  1.02it/s]  5%|▍         | 213/4419 [05:50<1:16:12,  1.09s/it]  5%|▍         | 214/4419 [05:52<1:21:41,  1.17s/it]  5%|▍         | 215/4419 [05:53<1:28:59,  1.27s/it]  5%|▍         | 216/4419 [05:54<1:28:59,  1.27s/it]  5%|▍         | 217/4419 [05:56<1:28:56,  1.27s/it]  5%|▍         | 218/4419 [05:58<1:58:59,  1.70s/it]  5%|▍         | 219/4419 [06:01<2:20:00,  2.00s/it]  5%|▍         | 220/4419 [06:04<2:34:39,  2.21s/it]  5%|▌         | 221/4419 [06:06<2:44:52,  2.36s/it]  5%|▌         | 222/4419 [06:09<2:52:03,  2.46s/it]  5%|▌         | 223/4419 [06:11<2:46:56,  2.39s/it]  5%|▌         | 224/4419 [06:14<2:43:33,  2.34s/it]  5%|▌         | 225/4419 [06:16<2:40:51,  2.30s/it]  5%|▌         | 226/4419 [06:18<2:39:13,  2.28s/it]  5%|▌         | 227/4419 [06:19<2:17:57,  1.97s/it]  5%|▌         | 228/4419 [06:21<2:03:07,  1.76s/it]  5%|▌         | 229/4419 [06:23<2:23:58,  2.06s/it]  5%|▌         | 230/4419 [06:26<2:38:27,  2.27s/it]  5%|▌         | 231/4419 [06:29<2:48:35,  2.42s/it]  5%|▌         | 232/4419 [06:33<3:28:55,  2.99s/it]  5%|▌         | 233/4419 [06:38<3:56:31,  3.39s/it]  5%|▌         | 234/4419 [06:42<4:15:58,  3.67s/it]  5%|▌         | 235/4419 [06:45<4:01:20,  3.46s/it]  5%|▌         | 236/4419 [06:48<3:51:17,  3.32s/it]  5%|▌         | 237/4419 [06:51<3:44:00,  3.21s/it]  5%|▌         | 238/4419 [06:54<3:38:54,  3.14s/it]  5%|▌         | 239/4419 [06:57<3:35:18,  3.09s/it]  5%|▌         | 240/4419 [06:58<2:52:53,  2.48s/it]  5%|▌         | 241/4419 [06:59<2:23:10,  2.06s/it]  5%|▌         | 242/4419 [07:00<2:02:26,  1.76s/it]  5%|▌         | 243/4419 [07:01<1:47:49,  1.55s/it]  6%|▌         | 244/4419 [07:02<1:42:33,  1.47s/it]  6%|▌         | 245/4419 [07:04<1:38:51,  1.42s/it]  6%|▌         | 246/4419 [07:05<1:36:21,  1.39s/it]  6%|▌         | 247/4419 [07:06<1:39:41,  1.43s/it]  6%|▌         | 248/4419 [07:08<1:41:58,  1.47s/it]  6%|▌         | 249/4419 [07:09<1:34:42,  1.36s/it]  6%|▌         | 250/4419 [07:10<1:29:40,  1.29s/it]  6%|▌         | 251/4419 [07:11<1:21:00,  1.17s/it]  6%|▌         | 252/4419 [07:12<1:14:59,  1.08s/it]  6%|▌         | 253/4419 [07:16<2:20:36,  2.03s/it]  6%|▌         | 254/4419 [07:20<3:06:37,  2.69s/it]  6%|▌         | 255/4419 [07:21<2:27:44,  2.13s/it]  6%|▌         | 256/4419 [07:22<2:00:33,  1.74s/it]  6%|▌         | 257/4419 [07:31<4:34:22,  3.96s/it]  6%|▌         | 258/4419 [07:40<6:16:36,  5.43s/it]  6%|▌         | 259/4419 [07:49<7:28:21,  6.47s/it]  6%|▌         | 260/4419 [07:51<5:50:47,  5.06s/it]  6%|▌         | 261/4419 [07:53<4:42:31,  4.08s/it]  6%|▌         | 262/4419 [07:54<3:44:39,  3.24s/it]  6%|▌         | 263/4419 [07:55<3:05:10,  2.67s/it]  6%|▌         | 264/4419 [07:56<2:36:33,  2.26s/it]  6%|▌         | 265/4419 [07:58<2:13:25,  1.93s/it]  6%|▌         | 266/4419 [07:59<1:57:04,  1.69s/it]  6%|▌         | 267/4419 [08:00<1:45:47,  1.53s/it]  6%|▌         | 268/4419 [08:01<1:37:50,  1.41s/it]  6%|▌         | 269/4419 [08:02<1:32:17,  1.33s/it]  6%|▌         | 270/4419 [08:03<1:22:40,  1.20s/it]  6%|▌         | 271/4419 [08:04<1:16:04,  1.10s/it]  6%|▌         | 272/4419 [08:10<2:50:05,  2.46s/it]  6%|▌         | 273/4419 [08:15<3:55:41,  3.41s/it]  6%|▌         | 273/4419 [08:17<2:05:50,  1.82s/it]
Traceback (most recent call last):
  File "/home/tobias.kalmbach/R-Tuning/training/WiCE/run_wice.py", line 110, in <module>
    output, full_input = inference(sample)
  File "/home/tobias.kalmbach/R-Tuning/training/WiCE/run_wice.py", line 58, in inference
    outputs = model.generate(
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/transformers/generation/utils.py", line 1437, in generate
    return self.greedy_search(
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/transformers/generation/utils.py", line 2248, in greedy_search
    outputs = self(
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 687, in forward
    outputs = self.model(
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 577, in forward
    layer_outputs = decoder_layer(
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 292, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/tobias.kalmbach/.conda/envs/lmflow/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 214, in forward
    attn_weights = torch.matmul(query_states, key_states.transpose(2, 3)) / math.sqrt(self.head_dim)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 66.95 GiB (GPU 0; 79.26 GiB total capacity; 16.59 GiB already allocated; 58.08 GiB free; 20.68 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
